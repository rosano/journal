<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{{- partial "page-title.html" . -}}</title>

{{ $options := (dict "outputStyle" "compressed" "enableSourceMap" true) }}
{{ $style := resources.Get "css/_gather.scss" | resources.ToCSS $options }}
<link rel="stylesheet" href="{{ $style.Permalink }}" />
{{ if not (and (eq .Kind "term") (or (eq .Data.Plural "years") (eq .Data.Plural "months") (eq .Data.Plural "days"))) }}
	{{ range .AlternativeOutputFormats -}}
	  <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink | safeURL }}" title="{{- partial "page-title.html" page -}}">
	{{ end }}
{{ end }}

</head>
<body>

<header>
	<h2>
		<a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a>
	</h2>
</header>

{{- block "main" . }}{{- end }}

<footer>
	
{{ if (and .Paginator (ne .Paginator.TotalPages 0)) }}

<div class="paginator">
	<span>
		{{ if .Paginator.HasNext }}<a class="older" href="{{ .Paginator.Next.URL }}">Older</a>{{ end }}
	</span>
	<span>
		{{ if .Paginator.HasPrev }}<a class="newer" href="{{ .Paginator.Prev.URL }}">Newer</a>{{ end }}
	</span>
</div>

{{ end }}

<small class="types">
	<a href="{{ .Site.BaseURL }}">all</a>
	
	<span>·</span>
	
	{{ range .Site.Taxonomies.categories.ByCount }}
		<a href="{{ .Page.Permalink }}">{{ .Page.LinkTitle }}</a>
	{{ end }}
</small>

<small class="time">
	<a href="{{ .Site.BaseURL }}">recent</a>
	
	<span>·</span>

	{{ if .IsHome }}
		{{ range .Site.Taxonomies.years }}
			<a href="{{ .Page.Permalink }}">{{ .Page.LinkTitle }}</a>
		{{ end }}
	{{ end }}

	{{ $underYear := or (in (slice "years" "months" "days") .Section) .IsPage }}
	
	{{ if $underYear }}
		{{ $year := substr .Page.Title 0 4 }}

		{{ if eq .Section "years" }}
			<span>{{ $year }}</span>
		{{ else }}
			<a href="/{{ $year }}">{{ $year }}</a>
		{{ end }}
		
		<span>·</span>

		{{ if eq .Section "years" }}
			{{ range .Site.Taxonomies.months }}
				{{ if strings.Contains .Page.LinkTitle $year }}
					{{ $t := time.AsTime (delimit (slice .Page.LinkTitle "01") "-") }}
					<a href="{{ .Page.Permalink }}">{{ time.Format "Jan" $t }}</a>
				{{ end }}
			{{ end }}
		{{ end }}
	{{ end }}

	{{ if eq .Section "months" }}
		{{ $month := .Page.Title }}
		{{ $t := time.AsTime (delimit (slice $month "01") "-") }}
		<span>{{ time.Format "January" $t }}</span>
		{{ range .Site.Taxonomies.days }}
			{{ if strings.Contains .Page.LinkTitle $month }}
				{{ $t := time.AsTime .Page.LinkTitle }}
				{{ $format := time.Format "2" $t }}
				{{ $last := substr $format -1 }}
				
				<a href="{{ .Page.Permalink }}">{{ $format }}{{ cond (eq $last "1") "st" (cond (eq $last "2") "nd" (cond (eq $last "3") "rd" "th")) }}</a>
			{{ end }}
		{{ end }}
	{{ end }}
</small>

</footer>

{{- partial "media-embeds.html" . -}}

</body>
</html>
